100;PWM.PIC
110 __CONFIG 0X3FF9
120 #INCLUDE "P16F873.INC"
130 ;
140    ORG 0   
150    GOTO INIT
160    ORG 4   
170    GOTO INT
180INIT        
181;INIT I/O   
190    BSF   STATUS,RP0
200    MOVLW 0X01
210    MOVWF TRISA
220    CLRF  TRISC     
230    BCF   STATUS,RP0
240;INIT A/D
250    MOVLW 0X81   
260    MOVWF ADCON0   
270    BSF   STATUS,RP0
280    MOVLW 0X0E   
290    MOVWF ADCON1   
300    BCF   STATUS,RP0
310;INIT TIMER
320    CLRF  TMR2
330    CLRF  CCPR1L
340    BSF   STATUS,RP0
350    MOVLW 0XFF
360    MOVWF PR2
370    BCF   STATUS,RP0
380    MOVLW 0X06
390    MOVWF T2CON  
400    MOVLW 0X0C 
410    MOVWF CCP1CON
420;INIT PWM
430    CLRF  TMR1H 
440    CLRF  TMR1L
450    MOVLW 0X09
460    MOVWF CCPR2H
470    MOVLW 0XC4
480    MOVWF CCPR2L
490    MOVLW 0X01
500    MOVWF T1CON
510    MOVLW 0X0B
520    MOVWF CCP2CON
530;INIT INTERRUPT
540    BSF   STATUS,RP0
550    MOVLW 0X01
560    MOVWF PIE2
570    BCF   STATUS,RP0
580    MOVLW 0XC0
590    MOVWF INTCON
600;MAIN LOOP
610WAIT
620    GOTO  WAIT
630;INTERRUPT
640INT
650    CLRF  PIR2
660ADCK
670    BTFSC ADCON0,GO
680    GOTO  ADCK
690    MOVF  ADRESH,W
700    MOVWF CCPR1L
710    MOVWF PORTC
720    RETFIE
730;
740END
